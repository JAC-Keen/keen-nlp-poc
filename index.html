<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>post demo</title>
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
</head>
  <body>

    <img src="css/keen.png" alt="Keen-Logo" class="center">

    <h1><u>Feedback Form</u></h1>
    <h2>Tell us about your experience today?</h2>
    <form id="contactForm1" action="https://us-central1-keen-nth-poc.cloudfunctions.net/function-anthem-dupe"  method="POST">
      <input type="text" id="s" placeholder="Feedback..">
      <input id="submit" type="submit" value="send">
    </form>


    <div id="thankyou" style="display:none"><p>Thank you for your Feedback!</p></div>

    <script type="text/javascript">
      // Keen Auto Collector
      (function(name,path,ctx){ctx[name]=ctx[name]||{ready:function(fn){var h=document.getElementsByTagName('head')[0],s=document.createElement('script'),w=window,loaded;s.onload=s.onerror=s.onreadystatechange=function(){if((s.readyState&&!(/^c|loade/.test(s.readyState)))||loaded){return}s.onload=s.onreadystatechange=null;loaded=1;ctx[name].ready(fn)};s.async=1;s.src=path;h.parentNode.insertBefore(s,h)}}})
      ('KeenTracking', 'https://cdn.jsdelivr.net/npm/keen-tracking@4/dist/keen-tracking.min.js', this);

      KeenTracking.ready(function(){
        const client = new KeenTracking({
          projectId: '5c2e3be8c9e77c0001ed971f',
          writeKey: '6188D519C7F63142175FF26C2658707369D1050D48F0FBE3277561FCF1C90F5E0B0FDAD945169531E445E6C0CDD062B0DDBF2D4D258A94A044F817CCEBCE774BDD87BD17AB85F8B24FC12E610187516C4A3AB25045CF56FCA7EF5591FC56302F'
        });

        // Record events automatically
        client.initAutoTracking();
      });
      // Tracking Form Event
      var frm = $('#contactForm1');
      frm.submit(function (e) {
        e.preventDefault();
        $.ajax({
            type: "POST",
            url: "https://us-central1-keen-nth-poc.cloudfunctions.net/function-anthem-dupe",
            data: JSON.stringify({ review_text: $('#s').val() }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function(data){alert(data);},
            failure: function(errMsg) {
                alert(errMsg);
            }
        });
      });

      // $('#submit').click(function(){
      //  alert('Thank you for submitting your feedback!');
      // });

      $("#submit").click(function(){
        $("#contactForm1").hide();
      });

      $("#submit").click(function(){
        $("#thankyou").show();
      });

    // Forced Ajax Test
    // $.ajax({
    //   type: "post",
    //   url: "https://us-central1-keen-nth-poc.cloudfunctions.net/function-anthem-dupe",
    //   // contentType: "application/json; charset=UTF-8",
    //   data: {"review_text": "This doc was quite literally a life saver for me."},
    //   dataType: "json",
    //   crossDomain: true,
    //   success: function(data){ alert(data); },
    //   failure: function(data){ alert(data); }
    // });

    </script>
  </body>
  <div id="shoes" align="center">
    Brought to you by Keen: Jorge Cano
  </div>
</html>
